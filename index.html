<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PSICO MANAGER - Gerenciamento de Pacientes e Relatórios</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

    <div id="loginScreen">
        <div class="login-card">
            <h2>PSICO MANAGER</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label for="loginPassword">Senha de Acesso:</label>
                    <input type="password" id="loginPassword" required placeholder="Digite sua senha">
                </div>
                <p id="loginStatus" class="alert"></p>
                <button type="submit">Entrar</button>
            </form>
        </div>
    </div>
    
    <div id="mainContent" style="display: none;">
        
        <div class="sidebar">
            <h2>PSICO MANAGER</h2>
            <a id="navClientes" class="active" data-view="clientes">Clientes/Sessões</a>
            <a id="navRelatorios" data-view="relatorios">Relatórios Financeiros</a>
            <a id="navLogout" onclick="logout()" style="margin-top: 30px; color: #e74c3c;">Sair (Logout)</a>
        </div>

        <div class="content">

            <div class="header">
                <h1 id="mainTitle">Gerenciamento de Clientes e Sessões</h1>
                <div id="top-buttons">
                    <button id="btnVerPacientes">Ver Todos os Clientes</button>
                </div>
            </div>

            <div class="card">
                
                <div id="viewClientes" class="view-content">
                    
                    <form id="buscaForm">
                        <div class="form-group">
                            <label for="buscaCpf">Buscar cliente pelo **CPF** (somente números):</label>
                            <input type="text" id="buscaCpf" required placeholder="Digite o CPF">
                        </div>
                        <button type="submit">Buscar Cliente</button>
                    </form>
                    
                    <p id="statusMensagem" class="alert"></p>

                    <div id="alertaCadastro" class="alert-info" style="display:none;">
                        O cliente com o CPF <span id="cpfNaoEncontrado"></span> não foi encontrado. Por favor, preencha o cadastro.
                    </div>

                    <form id="cadastroForm" style="display:none;" class="card">
                        <h2>Cadastro Rápido de Novo Cliente</h2>
                        <input type="hidden" name="action" value="cadastrarPaciente">
                        
                        <div class="form-group">
                            <label for="cNome">Nome Completo:</label>
                            <input type="text" name="nome" id="cNome" required>
                        </div>
                        <div class="form-group">
                            <label for="cCPF">CPF:</label>
                            <input type="text" name="cpf" id="cCPF" required readonly>
                        </div>
                        <div class="form-group">
                            <label for="cPreco">Preço da Sessão (R$):</label>
                            <input type="number" name="preco" id="cPreco" step="0.01" min="0" value="0.00" required>
                        </div>
                        
                        <button type="submit">Finalizar Cadastro</button>
                    </form>


                    <div id="dadosPaciente" style="display:none;" class="card">
                        <h2>Informações do Cliente</h2>
                        <div class="dados-paciente">
                            <p><b>Nome:</b> <span id="pNome"></span></p>
                            <p><b>CPF:</b> <span id="pCPF"></span></p>
                            <p><b>Preço da Sessão:</b> R$ <span id="pPreco"></span></p>
                            <p><b>Tratamento:</b> <span id="pTratamento"></span></p>
                        </div>
                        
                        <div class="relatorio-summary">
                            <div class="relatorio-item total-mes">
                                <h4><span id="pSessoesMes">0</span></h4>
                                <p>Sessões **Neste Mês**</p>
                            </div>
                            <div class="relatorio-item total-mes">
                                <h4>R$ <span id="pTotalMes">0.00</span></h4>
                                <p>**Valor a Pagar** (Este Mês)</p>
                            </div>
                            <div class="relatorio-item total-geral">
                                <h4><span id="pSessoesTotal">0</span></h4>
                                <p>Sessões **Total**</p>
                            </div>
                            <div class="relatorio-item total-geral">
                                <h4>R$ <span id="pTotalGeral">0.00</span></h4>
                                <p>Faturamento **Total**</p>
                            </div>
                        </div>

                        
                        <h3>Registrar Nova Sessão</h3>
                        <form id="novaSessao">
                            <input type="hidden" name="action" value="registrarSessao">
                            <input type="hidden" name="cpf" id="nCPF">
                            
                            <div class="form-group">
                                <label for="data_sessao">Data da Sessão:</label>
                                <input type="date" name="data_sessao" id="data_sessao" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="anotacao">Anotação/Descrição da Consulta:</label>
                                <textarea name="anotacao" id="anotacao" rows="4" placeholder="Detalhes da consulta, evolução do paciente, e observações."></textarea>
                            </div>

                            <button type="submit">Salvar Sessão e Anotação</button>
                        </form>
                        
                        <h3>Histórico de Sessões Anteriores</h3>
                        <div id="pHistorico" class="historico"></div>
                    </div>

                    <div id="listaPacientesContainer" style="display:none;" class="card">
                        <h2>Lista de Clientes Cadastrados</h2>
                        <ul id="listaPacientes"></ul>
                    </div>

                </div>
                
                <div id="viewRelatorios" class="view-content" style="display:none;">
                    <h2>Relatório Financeiro por Período</h2>
                    
                    <p id="statusMensagemRelatorio" class="alert"></p>
                    
                    <form id="filtroRelatorioForm" class="filtro-form">
                        <div class="form-group">
                            <label for="dataInicio">Data de Início:</label>
                            <input type="date" id="dataInicio" required>
                        </div>
                        <div class="form-group">
                            <label for="dataFim">Data de Fim:</label>
                            <input type="date" id="dataFim" required>
                        </div>
                        <button type="submit">Filtrar Relatório</button>
                    </form>
                    
                    <div id="relatorioContent">
                        <div class="relatorio-summary">
                            <div class="relatorio-item total-mes">
                                <h4><span id="rSessoesFiltradas">0</span></h4>
                                <p>Sessões no Período</p>
                            </div>
                            <div class="relatorio-item total-geral">
                                <h4>R$ <span id="rTotalFiltrado">0.00</span></h4>
                                <p>Faturamento no Período</p>
                            </div>
                        </div>
                        
                        <h3>Status de Pagamento por Cliente no Período</h3>
                        <table id="tabelaRelatorioMensal" style="width:100%;">
                            <thead>
                                <tr>
                                    <th>Cliente</th>
                                    <th>Sessões</th>
                                    <th>Valor Total (R$)</th>
                                    <th>Status</th>
                                    <th>Ação</th>
                                </tr>
                            </thead>
                            <tbody>
                                </tbody>
                        </table>
                    </div>
                </div>

            </div>
        </div>
    </div> 

    <script src="script.js"></script>
</body>
</html>
